{% extends "photo/base_dashboard.html" %}

{% block title %}User Dashboard{% endblock title %}

{% block photo_list %}
    {% for photo in photos %}
    <div class="highlight">
        <a href="{% url 'photo:user_home' %}?photo={{ photo.id }}">
        <div class="row">
            <div class="small-12 medium-6 columns">
                <img src="{{ photo.photo.url }}" height="80" width="80">
            </div>
            <div class="small-12 medium-6 columns">
                <p><strong>{{ photo.caption }}</strong></p>
            </div>
        </div>
        </a>
    </div>        
    {% endfor %}    
{% endblock photo_list %}

{% block stage %}
    <div class="row">
        <div class="small-12 columns">
            {% if messages %}
            <div class="alert callout">
                {% for message in messages %}
                <p>
                    {{ message }}
                </p>
                {% endfor %}
                <button class="close-button" aria-label="Dismiss alert" type="button" data-close>
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            {% endif %}
        </div>
    </div>
  
    {% if staged_photo %}
        <div class="row">
            <div class="small-12 columns">
                <a href="{{ staged_photo.display_image }}" class="tiny button" download><i class="fi-download"></i> Download</a>
                <button id="share_button" type="button" class="tiny button float-right"><i class="fi-share"></i> Share</button>
            </div>
            <div class="small-12 columns">
                <img class="staged_img float-center" src="{{ staged_photo.display_image }}">
            </div>
            <div class="small-12 columns">
                <a href="{% url 'photo:user_home' %}?photo={{staged_photo.id}}&effect=nigeria" class="button">Nigeria</a>
                <a href="{% url 'photo:user_home' %}?photo={{staged_photo.id}}&effect=france" class="button">France</a>
                <a href="{% url 'photo:user_home' %}?photo={{staged_photo.id}}&effect=usa" class="button">USA</a>
                <a href="{% url 'photo:user_home' %}?photo={{staged_photo.id}}&effect=kenya" class="button">Kenya</a>
                <a href="{% url 'photo:user_home' %}?photo={{staged_photo.id}}&effect=russia" class="button">Russia</a>
                <a href="{% url 'photo:user_home' %}?photo={{staged_photo.id}}&effect=double" class="button">Double</a>
            </div>
        </div> 

        <!-- facebook sharing -->
        <script type="text/javascript">
            var urlPrefix = location.protocol + '//' + location.host + '{{staged_photo.display_image}}';
            $(document).ready(function(){
            $('#share_button').click(function(e){
                console.log(urlPrefix);
            e.preventDefault();
            FB.ui(
              {
                method: 'feed',
                display: 'popup',
                caption: '{{staged_photo.caption}}',
                picture: urlPrefix,
                description: 'Created using ShutterPix'
              },
              // callback
              function(response) {}
            );
            });
            });
        </script>   
    {% endif %}
{% endblock stage %}